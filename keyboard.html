<!DOCTYPE html>
<html>
<head>
  <title>||Working with elements||</title>
  <style>
    #keyboard {
      display: flex;
    }
    .white-key {
      height: 100px;
      width: 28px;
      background-color: white;
      outline-style: solid;
      outline-width: thin
    }

    .black-key {
      height: 60px;
      background-color: black;
      position: absolute;
      outline-style: solid;
      outline-width: thin
    }
  </style>
</head>
<body>
  <div id="description"></div>
  <div id="keyboard"></div>
  <script> 
    const keyNames = ['C', 'C#/Db', 'D', 'D#/Eb', 'E', 'F', 'F#/Gb', 'G', 'G#/Ab', 'A', 'A#/Bb', 'B']
    const keyboard = document.getElementById('keyboard')

    document.body.onload = addKeys(14);
    window.addEventListener('load', resizeAllBlackKeys)
    window.addEventListener('resize', resizeAllBlackKeys)

    const allBlackKeysArray = Array.from(document.getElementsByClassName('black-key'))
    
    function addKeys(numKeys) {
      const keysPerOctave = 11
      let i = 0;
      let keyCount = 0;
      while(i < numKeys) {
        // create a new rectangle div element
        const newDiv = document.createElement("div");
        newDiv.classList.add('white-key')
        newDiv.setAttribute('key', `${keyNames[keyCount]}`)
        console.log(newDiv.getAttribute('key'))
    
        // add the newly created element and its content into the DOM
        keyboard.appendChild(newDiv);

        if(keyCount < keysPerOctave) {
          if(blackKeyCheck(keyCount)) {
            keyCount++
            addBlackKey(keyCount);
          }
          keyCount++
        }
        else {
          keyCount = 0 
        }
          
        i++
      }

      const totalKeyCount = keyboard.childElementCount;
      document.getElementById("description").innerHTML = `Below should be a keyboard with ${totalKeyCount} keys.`;
    }

    function addBlackKey(keyCount) {
      const newDiv = document.createElement("div");
      newDiv.classList.add('black-key')
      newDiv.setAttribute('key', `${keyNames[keyCount]}`)
      keyboard.appendChild(newDiv);
      sizeBlackKey(newDiv)
    }

    function blackKeyCheck(keyCount) {
      const whiteKeysNeedingBlackKeys = [0,1,2,5,7,9]
      return whiteKeysNeedingBlackKeys.includes(keyCount)
    }
    
    function resizeAllBlackKeys() {
      allBlackKeysArray.forEach(sizeBlackKey)
    }
    
    function sizeBlackKey(blackKey) {
      const whiteKeySibling = blackKey.previousElementSibling
      const whiteKeySiblingCoords = getPos(whiteKeySibling)
      blackKey.style.width = `${whiteKeySibling.offsetWidth / 2}px`
      blackKey.style.left = `${whiteKeySiblingCoords.right - (blackKey.offsetWidth / 2)}px`
    }

    function getPos(el) {
      return el.getBoundingClientRect();
    }
  </script>
</body>
</html>
